<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘å¸ƒä¸­å¿ƒæ¨¡å—E-Rå›¾</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        .er-container {
            background: linear-gradient(135deg, #a3bded 0%, #6991c7 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .er-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin: 20px auto;
            max-width: 1200px;
            overflow: hidden;
        }
        .er-header {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .er-content {
            padding: 30px;
            min-height: 600px;
        }
        .entity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .entity-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #74b9ff;
            transition: transform 0.3s ease;
        }
        .entity-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="er-container">
    <div class="er-card">
        <div class="er-header">
            <h1 class="text-3xl font-bold mb-2">å‘å¸ƒä¸­å¿ƒæ¨¡å—E-Rå›¾</h1>
            <p class="text-lg opacity-90">å¸–å­å‘å¸ƒã€å†…å®¹ç®¡ç†ã€äº’åŠ¨åŠŸèƒ½çš„å®ä½“å…³ç³»</p>
        </div>
        
        <div class="er-content">
            <!-- Mermaid E-Rå›¾ -->
            <div class="mermaid">
erDiagram
    %% å¸–å­æ ¸å¿ƒå®ä½“
    Post {
        int id PK "å¸–å­ID"
        string title "å¸–å­æ ‡é¢˜"
        text content "å¸–å­å†…å®¹"
        int author_id FK "ä½œè€…ID"
        int tieba_id FK "è´´å§ID"
        string post_type "å¸–å­ç±»å‹"
        bool is_published "æ˜¯å¦å‘å¸ƒ"
        int views_count "æµè§ˆæ•°"
        int likes_count "ç‚¹èµæ•°"
        int comments_count "è¯„è®ºæ•°"
        int shares_count "åˆ†äº«æ•°"
        string tags "æ ‡ç­¾"
        datetime created_at "åˆ›å»ºæ—¶é—´"
        datetime last_reply_at "æœ€åå›å¤æ—¶é—´"
    }
    
    %% å¸–å­å›¾ç‰‡å®ä½“
    PostImage {
        int id PK "å›¾ç‰‡ID"
        int post_id FK "å¸–å­ID"
        string image "å›¾ç‰‡è·¯å¾„"
        string caption "å›¾ç‰‡è¯´æ˜"
        int sort_order "æ’åº"
    }
    
    %% è¯„è®ºå®ä½“
    Comment {
        int id PK "è¯„è®ºID"
        int post_id FK "å¸–å­ID"
        int author_id FK "è¯„è®ºè€…ID"
        text content "è¯„è®ºå†…å®¹"
        int parent_id FK "çˆ¶è¯„è®ºID"
        int reply_to_id FK "å›å¤ç»™ID"
        int likes_count "ç‚¹èµæ•°"
        datetime created_at "åˆ›å»ºæ—¶é—´"
    }
    
    %% ç‚¹èµå®ä½“
    PostLike {
        int id PK "ç‚¹èµID"
        int post_id FK "å¸–å­ID"
        int user_id FK "ç”¨æˆ·ID"
        datetime created_at "ç‚¹èµæ—¶é—´"
    }
    
    CommentLike {
        int id PK "ç‚¹èµID"
        int comment_id FK "è¯„è®ºID"
        int user_id FK "ç”¨æˆ·ID"
        datetime created_at "ç‚¹èµæ—¶é—´"
    }
    
    %% æ”¶è—å®ä½“
    PostCollection {
        int id PK "æ”¶è—ID"
        int post_id FK "å¸–å­ID"
        int user_id FK "ç”¨æˆ·ID"
        datetime created_at "æ”¶è—æ—¶é—´"
    }
    
    %% è´´å§å®ä½“
    Tieba {
        int id PK "è´´å§ID"
        string name "è´´å§åç§°"
        string description "è´´å§æè¿°"
        int category_id FK "åˆ†ç±»ID"
        int creator_id FK "åˆ›å»ºè€…ID"
        int members_count "æˆå‘˜æ•°"
        int posts_count "å¸–å­æ•°"
        bool is_public "æ˜¯å¦å…¬å¼€"
        bool post_need_approve "å‘å¸–éœ€è¦å®¡æ ¸"
    }
    
    %% ç”¨æˆ·å®ä½“
    User {
        int id PK "ç”¨æˆ·ID"
        string username "ç”¨æˆ·å"
        string nickname "æ˜µç§°"
        string avatar "å¤´åƒ"
    }
    
    %% å…³ç³»å®šä¹‰
    User ||--o{ Post : "å‘å¸ƒå¸–å­"
    User ||--o{ Comment : "å‘è¡¨è¯„è®º"
    User ||--o{ PostLike : "ç‚¹èµå¸–å­"
    User ||--o{ CommentLike : "ç‚¹èµè¯„è®º"
    User ||--o{ PostCollection : "æ”¶è—å¸–å­"
    
    Tieba ||--o{ Post : "åŒ…å«å¸–å­"
    
    Post ||--o{ PostImage : "åŒ…å«å›¾ç‰‡"
    Post ||--o{ Comment : "åŒ…å«è¯„è®º"
    Post ||--o{ PostLike : "è¢«ç‚¹èµ"
    Post ||--o{ PostCollection : "è¢«æ”¶è—"
    
    Comment ||--o{ Comment : "å›å¤è¯„è®º"
    Comment ||--o{ CommentLike : "è¢«ç‚¹èµ"
            </div>
            
            <!-- åŠŸèƒ½è¯¦ç»†è¯´æ˜ -->
            <div class="entity-grid">
                <div class="entity-card">
                    <h3 class="text-xl font-semibold text-blue-600 mb-3">ğŸ“ å¸–å­ç®¡ç†</h3>
                    <ul class="space-y-2">
                        <li>â€¢ <strong>Post</strong>ï¼šå¸–å­æ ¸å¿ƒå®ä½“</li>
                        <li>â€¢ æ”¯æŒå¤šç§å¸–å­ç±»å‹</li>
                        <li>â€¢ å‘å¸ƒçŠ¶æ€ç®¡ç†</li>
                        <li>â€¢ æ ‡ç­¾åˆ†ç±»ç³»ç»Ÿ</li>
                        <li>â€¢ æ—¶é—´æˆ³è®°å½•</li>
                    </ul>
                </div>
                
                <div class="entity-card">
                    <h3 class="text-xl font-semibold text-blue-600 mb-3">ğŸ–¼ï¸ å†…å®¹é™„ä»¶</h3>
                    <ul class="space-y-2">
                        <li>â€¢ <strong>PostImage</strong>ï¼šå›¾ç‰‡é™„ä»¶ç®¡ç†</li>
                        <li>â€¢ å¤šå›¾ç‰‡æ”¯æŒ</li>
                        <li>â€¢ å›¾ç‰‡æ’åºåŠŸèƒ½</li>
                        <li>â€¢ å›¾ç‰‡è¯´æ˜æ–‡å­—</li>
                        <li>â€¢ å›¾ç‰‡é¢„è§ˆä¼˜åŒ–</li>
                    </ul>
                </div>
                
                <div class="entity-card">
                    <h3 class="text-xl font-semibold text-blue-600 mb-3">ğŸ’¬ è¯„è®ºç³»ç»Ÿ</h3>
                    <ul class="space-y-2">
                        <li>â€¢ <strong>Comment</strong>ï¼šè¯„è®ºå®ä½“</li>
                        <li>â€¢ æ¥¼ä¸­æ¥¼å›å¤åŠŸèƒ½</li>
                        <li>â€¢ å¤šçº§è¯„è®ºç»“æ„</li>
                        <li>â€¢ è¯„è®ºç‚¹èµç³»ç»Ÿ</li>
                        <li>â€¢ è¯„è®ºæ—¶é—´çº¿</li>
                    </ul>
                </div>
                
                <div class="entity-card">
                    <h3 class="text-xl font-semibold text-blue-600 mb-3">â¤ï¸ äº’åŠ¨åŠŸèƒ½</h3>
                    <ul class="space-y-2">
                        <li>â€¢ <strong>PostLike</strong>ï¼šå¸–å­ç‚¹èµ</li>
                        <li>â€¢ <strong>CommentLike</strong>ï¼šè¯„è®ºç‚¹èµ</li>
                        <li>â€¢ <strong>PostCollection</strong>ï¼šå¸–å­æ”¶è—</li>
                        <li>â€¢ å®æ—¶äº’åŠ¨ç»Ÿè®¡</li>
                        <li>â€¢ ç”¨æˆ·è¡Œä¸ºè®°å½•</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            er: {
                useMaxWidth: true,
                diagramPadding: 20
            }
        });
    </script>
</body>
</html>